<!-- <!DOCTYPE html>
 
<html lang="en">
 
<head>
 
<meta charset="UTF-8">
 
<title>Birmingham Museums Wi-Fi</title>
 
<meta name="viewport" content="width=device-width, initial-scale=1.0">
 
<style>
 
  body {
 
    font-family: Arial, sans-serif;
 
    text-align: center;
 
    padding: 40px;
 
    background: #f7f7f7;
 
  }
 
  .card {
 
    background: #fff;
 
    padding: 30px;
 
    max-width: 400px;
 
    margin: auto;
 
    border-radius: 10px;
 
    box-shadow: 0 4px 16px rgba(0,0,0,0.1);
 
  }
 
  button {
 
    background: #0077cc;
 
    color: #fff;
 
    border: none;
 
    padding: 15px 25px;
 
    font-size: 18px;
 
    border-radius: 6px;
 
    cursor: pointer;
 
  }
 
  p {
 
    color: #444;
 
  }
 
</style>
 
</head>
 
<body>
 
 
 
<div class="card">
 
<h2>Welcome to Birmingham Museums Wi-Fi 2</h2>
 
<p>Tap below to get connected.</p>
 
<p>If the page doesn’t open in your browser automatically, use the “Open in browser” button on the next screen.</p>
 
 
  <button onclick="connect()">Connect</button>
 
</div>
 
 
 
<script>
 
// Break out of captive portal iframe if loaded in one
if (window.top !== window.self) {
  window.top.location = window.self.location;
}
 
// Read Meraki query parameters from the URL
 
function getParam(name) {
 
  return new URLSearchParams(window.location.search).get(name);
 
}
 
 
 
function connect() {

  const grant = getParam("base_grant_url");

  // Try HTTP first to help break out of the captive portal browser; the next
  // page will bounce to HTTPS almost immediately.
  const cont  = "http://httpforever.com/";

  if (!grant) {
    alert("Missing Meraki base_grant_url parameter");
    return;
  }

  // Meraki accepts user_continue_url which can help some clients launch the
  // full browser after auth completes.
  const continueParam = encodeURIComponent(cont);
  const dest = `${grant}?continue_url=${continueParam}&user_continue_url=${continueParam}`;

  // Best effort: a user-gesture window.open can nudge some captive portals to
  // hand off to the native browser. Ignore failures/pop-up blocks.
  try { window.open(cont, "_blank"); } catch (e) {}

  // Use window.top to break out of captive portal iframe
  window.top.location.href = dest;

}
 
</script>
 
 
 
</body>
 
</html> -->









<!DOCTYPE html>

<html lang="en">

<head>

<meta charset="UTF-8">

<title>Birmingham Museums Wi-Fi</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>

  body {

    font-family: Arial, sans-serif;

    text-align: center;

    padding: 40px;

    background: #f7f7f7;

  }

  .card {

    background: #fff;

    padding: 30px;

    max-width: 400px;

    margin: auto;

    border-radius: 10px;

    box-shadow: 0 4px 16px rgba(0,0,0,0.1);

  }

  button {

    background: #0077cc;

    color: #fff;

    border: none;

    padding: 15px 25px;

    font-size: 18px;

    border-radius: 6px;

    cursor: pointer;

  }

  p {

    color: #444;

  }

</style>

</head>

<body>

 

<div class="card">

<h2>Welcome to Birmingham Museums Wi-Fi 2</h2>

<p>Tap below to get connected.</p>

 

  <button onclick="connect()">Connect</button>

</div>

 

<script>

// Break out of captive portal iframe if loaded in one
if (window.top !== window.self) {
  window.top.location = window.self.location;
}

// Read Meraki query parameters from the URL

function getParam(name) {

  return new URLSearchParams(window.location.search).get(name);

}

 

function connect() {

  const grant = getParam("base_grant_url");

  const cont  = "http://httpforever.com/";

  if (!grant) {
    alert("Missing Meraki base_grant_url parameter");
    return;
  }

  // Meraki accepts user_continue_url which can help some clients launch the
  // full browser after auth completes.
  const continueParam = encodeURIComponent(cont);
  const dest = `${grant}?continue_url=${continueParam}&user_continue_url=${continueParam}`;

  // Strategy: Force main browser to open using multiple techniques
  // The key is that user_continue_url tells Meraki to launch the main browser
  // and window.open with user gesture can also trigger main browser
  
  // CRITICAL: window.open() MUST be called synchronously with user click
  // This is the most reliable way to trigger main browser on iOS/Android
  // The user gesture (button click) is essential for this to work
  try {
    window.open(cont, "_blank");
  } catch (e) {
    // Pop-up may be blocked, but the attempt can still help trigger main browser
    // The user_continue_url parameter below is the backup mechanism
  }

  // Redirect to Meraki for authentication
  // The user_continue_url parameter is KEY - it tells Meraki to launch
  // the main browser when redirecting after authentication
  // Use window.top to break out of captive portal iframe
  try {
    // Use replace to avoid back button issues
    window.top.location.replace(dest);
  } catch (e) {
    // Fallback to href if replace fails
    window.top.location.href = dest;
  }

}

</script>

 

</body>

</html>

